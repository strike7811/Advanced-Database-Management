---Query 7 : Chef Handled Orders
---purpose - To know the ability of each chef.

set pagesize 120
set linesize 120

COLUMN CHEFNAME FORMAT A30 TRUNCATE HEADING 'CHEFNAME';
COLUMN CATEGORY FORMAT A10 HEADING 'CATEGORY';
COLUMN MENUDESC FORMAT A40 TRUNCATE HEADING 'MENU DESCRIPTION';
BREAK ON CHEFID SKIP 1 ON CHEFNAME;
COMPUTE SUM LABEL 'SUM' OF TOTAL_ORDERS ON CHEFID;

CREATE OR REPLACE VIEW QUERY7 AS
SELECT C.ChefID, ChefName, M.Category, MenuDesc, SUM(OD.FoodQty) AS Total_Orders
FROM Chef C, Menu M, OrderDetail OD
WHERE C.ChefID = M.ChefID AND M.MenuID = OD.MenuID
GROUP BY C.ChefID, ChefName, M.Category, MenuDesc
ORDER BY C.ChefID, ChefName, Total_Orders DESC;

SELECT * FROM QUERY7;

CLEAR COLUMNS
CLEAR BREAKS
CLEAR COMPUTES
